When trying to start a WebRTC video call on localhost we see the server immediately emits a webrtc-call-reject when the recipient is not connected, which closes the call UI. Fix the call-handling logic so that: if the recipient is offline, the caller still sees the video-call UI and a persistent "Calling…" state until the caller manually cancels/rejects the call (i.e., do not auto-reject). If the recipient is online, the caller should see a "Ringing…" state just like WhatsApp and the recipient should receive an incoming-call UI that they can accept or reject. Keep the behavior identical on localhost and production; update server and client logic so the server only auto-rejects when an explicit offline policy is required, otherwise let the caller control cancellation.

Acceptance criteria (short)

Caller initiates call → recipient offline → caller sees video-call UI with "Calling…" and a cancel button; no immediate webrtc-call-reject from server.

Caller initiates call → recipient online → caller sees "Ringing…"; recipient receives incoming call event/UI.

If caller cancels while recipient is offline, server notifies recipient (if they later connect) or logs the canceled call appropriately.

No regressive behavior for existing online calls.

Minimal pseudocode (client + server notes)

Client (caller):

send call-offer to server with target user ID

show call UI and set state = CALLING immediately

if receives call-accepted → transition to IN_CALL

if receives call-rejected → close UI

cancel button → send call-cancel to server and close UI

Server:

on call-offer: if recipient is connected → forward incoming-call to recipient and reply to caller that recipient is reachable (client shows RINGING); if recipient not connected → do NOT auto-emit webrtc-call-reject; instead persist or mark offer as pending and reply to caller with recipient-offline (client stays CALLING)

on call-cancel: if pending/offline → mark canceled and optionally notify recipient on next connect

on recipient connect: if there is pending offer → forward incoming-call (unless canceled)

Recipient:

on incoming-call → show ringing UI; accept → send call-accept to server, reject → send call-reject